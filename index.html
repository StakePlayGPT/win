<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Stake Play</title>

  <!-- PWA -->
  <link rel="manifest" href="/win/manifest.json">
  <meta name="theme-color" content="#000000">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/win/sw.js').catch(console.error);
    }
  </script>

  <style>
    :root {
      --bg:#0b0b0c; --card:#131316; --line:#23232a; --fg:#fff; --muted:#9aa0a6; --accent:#22c55e;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;
      background:var(--bg); color:var(--fg); font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
    }
    .wrap{padding:24px; width:min(560px,100%)}
    .card{
      background:var(--card); border:1px solid var(--line); border-radius:16px; padding:24px;
      text-align:center; box-shadow:0 12px 30px rgba(0,0,0,.35);
    }
    h1{margin:0 0 8px;font-size:28px}
    p{margin:0 0 20px;color:var(--muted)}
    .btn{
      display:inline-block; padding:12px 18px; border-radius:10px; text-decoration:none; font-weight:600;
    }
    .btn-primary{background:var(--accent); color:#0b0b0c}

    /* –ë–ê–ù–ù–ï–†-–ü–û–î–°–ö–ê–ó–ö–ê */
    .a2hs{
      position:fixed; left:12px; right:12px; bottom:12px; z-index:50;
      background:#15151a; border:1px solid var(--line); color:var(--fg); border-radius:14px;
      padding:12px 14px; display:none; gap:12px; align-items:flex-start;
      box-shadow:0 10px 24px rgba(0,0,0,.35);
    }
    .a2hs.visible{display:flex}
    .a2hs .txt{font-size:14px; color:#d9d9de}
    .a2hs .muted{color:var(--muted)}
    .a2hs .actions{margin-left:auto; display:flex; gap:8px}
    .a2hs button,.a2hs a{padding:8px 12px; border-radius:10px; border:1px solid var(--line); background:#1b1b20; color:#fff; cursor:pointer; text-decoration:none}
    .a2hs .ok{background:var(--accent); color:#0b0b0c; border-color:#149a49}
    .a2hs .close{background:#25252b}
    .hint-steps{margin:.3rem 0 0; line-height:1.45}
    .icon-share{display:inline-block; width:14px; height:14px; border:2px solid currentColor; border-radius:3px; position:relative; top:2px; margin:0 3px}
    .icon-share::after{content:"‚Üë"; position:absolute; left:2px; top:-8px; font-weight:700; font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Stake Play</h1>
      <p>Accesso rapido ai segnali e ai giochi üéÆ</p>
      <a class="btn btn-primary" href="https://t.me/tuobot">–û—Ç–∫—Ä—ã—Ç—å –≤ Telegram</a>
    </div>
  </div>

  <!-- –ë–∞–Ω–Ω–µ—Ä –ø–æ–¥—Å–∫–∞–∑–∫–∏ (iOS/Android) -->
  <div id="a2hs" class="a2hs" role="region" aria-live="polite">
    <div class="txt" id="a2hs-text"></div>
    <div class="actions">
      <button id="a2hs-install" class="ok" style="display:none">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
      <button id="a2hs-close" class="close">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- –ë–∞–Ω–Ω–µ—Ä –¥–ª—è Instagram WebView -->
  <div id="ig-banner" class="a2hs" role="region" aria-live="polite">
    <div class="txt" id="ig-text"></div>
    <div class="actions">
      <a id="ig-open" class="ok" href="#">–û—Ç–∫—Ä—ã—Ç—å –≤–æ –≤–Ω–µ—à–Ω–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</a>
      <button id="ig-copy">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
      <a href="tg://resolve?domain=YOUR_BOT" class="close">–û—Ç–∫—Ä—ã—Ç—å –≤ Telegram</a>
      <button id="ig-close" class="close">√ó</button>
    </div>
  </div>

  <script>
    (function(){
      const ua = navigator.userAgent.toLowerCase();
      const isIOS = /iphone|ipad|ipod/.test(ua);
      const isAndroid = /android/.test(ua);
      const isIG = ua.includes('instagram');
      const isStandalone = window.matchMedia('(display-mode: standalone)').matches || navigator.standalone === true;

      const banner = document.getElementById('a2hs');
      const text   = document.getElementById('a2hs-text');
      const btnInstall = document.getElementById('a2hs-install');
      const btnClose   = document.getElementById('a2hs-close');

      const KEY = 'a2hs_dismissed_v1';
      if (!localStorage.getItem(KEY) && !isStandalone && !isIG) {
        let deferredPrompt = null;

        window.addEventListener('beforeinstallprompt', (e) => {
          e.preventDefault();
          deferredPrompt = e;
          if (isAndroid) {
            text.innerHTML = `
              <div><b>–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (Android)</b></div>
              <div class="hint-steps">
                –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É <b>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</b> –Ω–∏–∂–µ.<br>
                –ï—Å–ª–∏ –±–∞–Ω–Ω–µ—Ä –Ω–µ –ø–æ—è–≤–∏–ª—Å—è: –æ—Ç–∫—Ä–æ–π –º–µ–Ω—é <b>‚ãÆ</b> ‚Üí <b>–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω</b>.
              </div>
            `;
            btnInstall.style.display = 'inline-block';
            banner.classList.add('visible');
          }
        });

        btnInstall.addEventListener('click', async () => {
          if (!deferredPrompt) return;
          deferredPrompt.prompt();
          try { await deferredPrompt.userChoice; } catch(_) {}
          deferredPrompt = null;
          banner.classList.remove('visible');
          localStorage.setItem(KEY, '1');
        });

        if (isIOS) {
          text.innerHTML = `
            <div><b>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (iPhone)</b></div>
            <div class="hint-steps">
              1) –ù–∞–∂–º–∏ <span class="icon-share" aria-hidden="true"></span> <b>¬´–ü–æ–¥–µ–ª–∏—Ç—å—Å—è¬ª</b> –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞.<br>
              2) –í—ã–±–µ—Ä–∏ <b>¬´–ù–∞ —ç–∫—Ä–∞–Ω ‚Äú–î–æ–º–æ–π‚Äù¬ª</b>.<br>
              3) –ù–∞–∂–º–∏ <b>¬´–î–æ–±–∞–≤–∏—Ç—å¬ª</b>.
            </div>
            <div class="muted">–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∞–π—Ç –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –±–µ–∑ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.</div>
          `;
          banner.classList.add('visible');
        }

        btnClose.addEventListener('click', () => {
          banner.classList.remove('visible');
          localStorage.setItem(KEY, '1');
        });

        window.addEventListener('appinstalled', () => {
          banner.classList.remove('visible');
          localStorage.setItem(KEY, '1');
        });
      }

      // Instagram WebView ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä
      if (isIG && !isStandalone) {
        const igBanner = document.getElementById('ig-banner');
        const igText = document.getElementById('ig-text');
        const igBtn = document.getElementById('ig-open');
        const igCopy = document.getElementById('ig-copy');
        const igClose = document.getElementById('ig-close');
        const URL_NOW = location.href.split('#')[0];

        if (isIOS) {
          igText.innerHTML = `
            <b>–í—ã –æ—Ç–∫—Ä—ã–ª–∏ —Å–∞–π—Ç –≤ Instagram</b><br>
            –ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω: –æ—Ç–∫—Ä–æ–π –≤ Safari.<br>
            –ù–∞–∂–º–∏ ‚ãØ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É ‚Üí <b>–û—Ç–∫—Ä—ã—Ç—å –≤ System Browser</b>,<br>
            –∑–∞—Ç–µ–º <b>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è ‚Üí –ù–∞ —ç–∫—Ä–∞–Ω –î–æ–º–æ–π ‚Üí –î–æ–±–∞–≤–∏—Ç—å</b>.
          `;
          igBtn.href = URL_NOW;
        } else {
          igText.innerHTML = `
            <b>–í—ã –æ—Ç–∫—Ä—ã–ª–∏ —Å–∞–π—Ç –≤ Instagram</b><br>
            –ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω: –æ—Ç–∫—Ä–æ–π –≤ Chrome.<br>
            –ù–∞–∂–º–∏ ‚ãÆ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É ‚Üí <b>–û—Ç–∫—Ä—ã—Ç—å –≤ Chrome</b>,<br>
            –∑–∞—Ç–µ–º <b>‚ãÆ ‚Üí –î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω</b>.
          `;
          const intent = `intent://${location.host}${location.pathname}#Intent;scheme=https;package=com.android.chrome;S.browser_fallback_url=${encodeURIComponent(URL_NOW)};end`;
          igBtn.href = intent;
        }

        igCopy.onclick = async () => {
          try { await navigator.clipboard.writeText(URL_NOW); alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞. –û—Ç–∫—Ä–æ–π –µ—ë –≤ Safari/Chrome.'); }
          catch { prompt('–°–∫–æ–ø–∏—Ä—É–π —Å—Å—ã–ª–∫—É –≤—Ä—É—á–Ω—É—é:', URL_NOW); }
        };

        igClose.onclick = () => igBanner.remove();

        igBanner.classList.add('visible');
      }
    })();
  </script>
</body>
</html>
